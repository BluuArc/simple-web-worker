"use strict";function _postAll(){var r=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(n))return console.error(new TypeError(__errorMsg$3(n))),null;var e=_isArrayOfArrays(n),o=_isArrayOfObjects(n),t=_isArrayOfStrings(n);if(!(e||o||t))return console.error(new TypeError(__errorMsg$3(n))),null;if(0===n.length)return Promise.all(this.actions.map(function(n){var e=n.message;return r.postMessage(e)}));if(t)return Promise.all(n.map(function(n){return r.postMessage(n)}));if(o){return n.some(function(r){return!r.hasOwnProperty("message")||!r.hasOwnProperty("args")})?(console.error(new TypeError(__errorMsgWrongObjects(n))),null):Promise.all(n.map(function(n){var e=n.message,o=n.args;return r.postMessage(e,o)}))}return e?n.length!==this.actions.length?(console.error(new TypeError(__errorMsgWrongLenght(n.length)(this.actions.length))),null):Promise.all(n.map(function(n,e){return r.postMessage(r.actions[e].message,n)})):null}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},__invalidActions=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(Array.isArray(r)){if("objectsArray"===n)return r.some(function(r){return"object"!==(void 0===r?"undefined":_typeof(r))||Array.isArray(r)||null===r});if("stringsArray"===n)return r.some(function(r){return"string"!=typeof r})}return!1}},__isArrayOf=function(r){return function(n){var e=null;return"arrays"===r&&(e=function(r){return Array.isArray(r)}),"objects"===r&&(e=function(r){return"object"===(void 0===r?"undefined":_typeof(r))&&!Array.isArray(r)}),"strings"===r&&(e=function(r){return"string"==typeof r}),!!e&&n.every(e)}},__isValidArgument=function r(n){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return"null"===e?null===n:"undefined"===e?void 0===n:Array.isArray(e)?e.some(function(e){return r(n)(e)}):!(!n||__wrongType(n,e)||__invalidActions(n)(e))}},__wrongType=function r(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Array.isArray(e)?e.every(function(e){return r(n,e)}):Array.isArray(n)?"objectsArray"!==e&&"stringsArray"!==e&&"array"!==e:(void 0===n?"undefined":_typeof(n))!==e.toString()},_isArrayOfArrays=function(r){return __isArrayOf("arrays")(r)},_isArrayOfObjects=function(r){return __isArrayOf("objects")(r)},_isArrayOfStrings=function(r){return __isArrayOf("strings")(r)},_isValidArgument=function(r){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(Array.isArray(n)){var o=n.some(function(n){return __isValidArgument(r)(n)});return o||console.error(new TypeError(e)),o}return!(!r||__wrongType(r,n)||__invalidActions(r)(n))||(console.error(new TypeError(e)),!1)}}},__disposablePost=function(r){return function(n){return new Promise(function(e,o){r.onmessage=function(r){return e(r.data)},r.onerror=function(r){console.error("Error: Line "+r.lineno+" in "+r.filename+": "+r.message),o(r)},r.postMessage({message:n})})}},_createDisposableWorker=function(r){var n=window.URL||window.webkitURL,e=new Blob([r],{type:"application/javascript"}),o=new Worker(n.createObjectURL(e));return o.post=__disposablePost(o),o},__createSinglePromise=function(r){var n=r.response,e=r.args;return _createDisposableWorker(n).post({args:e})},__makeResponse=function(r){return"\n  self.onmessage = event => {\n    const args = event.data.message.args\n    if (args) {\n      self.postMessage("+r+".apply(null, args))\n      return close()\n    }\n    self.postMessage("+r+"())\n    return close()\n  }\n"},__run=function(r){var n=r.work,e=r.args,o=__makeResponse(n);return __createSinglePromise({response:o,args:e})},__errorMsg$2=function(r){return function(n){try{return"You should provide "+r+".\nReceived: "+JSON.stringify(n)}catch(e){return"Converting circular structure to JSON"===e.message?"You should provide "+r+".\nReceived a circular structure: "+n:(console.error(e),"You should provide something else...")}}},_run=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments[1],e=[],o=__errorMsg$2("a function")(r),t=__errorMsg$2("an array")(n);return _isValidArgument(r)("function")(o)||e.push(o),_isValidArgument(n)(["array","undefined"])(t)||e.push(t),0===e.length?__run({work:r,args:n}):null},__errorMsg$1=function(r){return"You should provide a string.\nReceived: "+JSON.stringify(r)},_post=function(r){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments[1];if(_isValidArgument(n)("string")(__errorMsg$1(n))){var o=r.filter(function(r){var e=r.message;return JSON.stringify(e)===JSON.stringify(n)}).map(function(r){return r.func}).pop();return o?e?_run(o,e):_run(o):(o=function(r){return console.warn("WARN! "+r+" is not a registered action for this worker"),r+" is not a registered action for this worker"},e=JSON.stringify(n),_run(o,[e]))}return null}},__errorMsg$3=function(r){return"You should provide an array of strings, an array of objects, an array of arrays or no arguments.\nReceived: "+JSON.stringify(r)},__errorMsgWrongLenght=function(r){return function(n){return"You should provide the same number of [args] as the number of registered actions on the worker.\nThis worker has "+n+" actions registered.\nNumber of [args] received: "+r}},__errorMsgWrongObjects=function(r){return"Every object of the array must contain the following fields:\n* message\n* args\nReceived: "+JSON.stringify(r)},__errorMsg$4=function(r){return"You should provide an array of actions or an action. Every action should be an object containing two fields: `message` and `func`.\nReceived: "+JSON.stringify(r)},__pushInto=function(r){return function(n){return r.push(n)}},_register=function(r){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return _isValidArgument(n)(["object","objectsArray"])(__errorMsg$4(n))?Array.isArray(n)?(n.forEach(__pushInto(r)),r.length):__pushInto(r)(n):null}},__removeFrom=function(r){return function(n){var e=r.findIndex(function(r){return r.message===n});return-1===e?(console.warn("WARN! Impossible to unregister "+n+".\n"+n+" is not a registered action for this worker."),[]):r.splice(e,1)}},__errorMsg$5=function(r){return"You should provide an array of strings or a string.\nReceived: "+JSON.stringify(r)},_unregister=function(r){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(_isValidArgument(n)(["string","stringsArray"])(__errorMsg$5(n))){var e=__removeFrom(r);if(Array.isArray(n)){var o=n.reduce(function(r,n){return r=r.concat(e(n))},[]);return 0===o.length?(console.warn("WARN! Impossible to unregister "+JSON.stringify(n)+".\nNone of the actions is a registered action for this worker."),null):o}return e(n)}return null}},_createReusableWorker=function(r){return{actions:r,postMessage:_post(r),postAll:_postAll,register:_register(r),unregister:_unregister(r)}},__errorMsg=function(r){return"You should provide an array of objects and every action should be an object containing two fields: `message` and `func`.\nReceived: "+JSON.stringify(r)},_create=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return _isValidArgument(r)("objectsArray")(__errorMsg(r))?_createReusableWorker(r):null},WorkerWrapper=null;window.Worker?WorkerWrapper={create:_create,run:_run}:console.warn("Your browser does not support Workers.");var WorkerWrapper$1=WorkerWrapper;module.exports=WorkerWrapper$1;
//# sourceMappingURL=sww.min.js.map
